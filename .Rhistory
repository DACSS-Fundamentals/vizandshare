labs(title = "Regions with lowest Infant Mortality & Gini",
subtitle = "Count of countries in the worst quartile for both metrics",
x = "Region",
y = "Number of Countries") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
infant_good <- quantile(cia$infant, 0.1, na.rm = TRUE)
gini_good   <- quantile(cia$gini, 0.1, na.rm = TRUE)
cia$infant_great <- ifelse(cia$infant >= infant_good, 1, 0)
cia$gini_great   <- ifelse(cia$gini >= gini_good, 1, 0)
subset(cia, infant_great == 1 & gini_great == 1)['region']|>table()
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar() +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
subtitle = "Count of countries in the worst quartile for both metrics",
x = "Region",
y = "Number of Countries") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
infant_good <- quantile(cia$infant, 0.1, na.rm = TRUE)
gini_good   <- quantile(cia$gini, 0.1, na.rm = TRUE)
cia$infant_great <- ifelse(cia$infant <= infant_good, 1, 0)
cia$gini_great   <- ifelse(cia$gini <= gini_good, 1, 0)
subset(cia, infant_great == 1 & gini_great == 1)['region']|>table()
infant_good <- quantile(cia$infant, 0.25, na.rm = TRUE)
gini_good   <- quantile(cia$gini, 0.25, na.rm = TRUE)
cia$infant_great <- ifelse(cia$infant <= infant_good, 1, 0)
cia$gini_great   <- ifelse(cia$gini <= gini_good, 1, 0)
subset(cia, infant_great == 1 & gini_great == 1)['region']|>table()
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar() +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
subtitle = "Count of countries in the worst quartile for both metrics",
x = "Region",
y = "Number of Countries") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar() +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
subtitle = "Count of countries in the worst quartile for both metrics",
x = "Region",
y = "Number of Countries")
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar() +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
subtitle = "Count of countries in the best quartile for both metrics",
x = "Region",
y = "Number of Countries")
base +  geom_boxplot(aes(x=life_exp))
+  geom_boxplot(aes(x=infant))
base +  geom_boxplot(aes(x=life_exp)) +  geom_boxplot(aes(x=infant)) +  geom_boxplot(aes(x=maternal))
cia
cia[,c(1,2,3)])
cia[,c(1,2,3)]
cia[,c(1,2,3,4)]
head(cia[,c(1,2,3,4)])
ciaLong=tidyr::pivot_longer(data=cia[,c(1,2,3,4)],
cols=!name,
names_to = "vars",
values_to = "index")
ciaLong
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=index))
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=ave(index, vars, FUN = scale)))
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=ave(index, vars, FUN = scale)))
base + geom_boxplot(aes(x = vars, y = index)) +
scale_y_log10()
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar()
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data, aes(x = reorder(region, region, function(x) -length(x)))) +
geom_bar() +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data) +
geom_bar(aes(x = reorder(region, region, function(x) -length(x)))) +
theme_minimal() +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data) +
geom_bar(aes(x = reorder(region, region, function(x) -length(x)))) +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
library(ggplot2)
# 1. Create the data frame from your logic
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# 2. Plot using geom_bar (it counts the occurrences automatically)
ggplot(plot_data) +
geom_bar(aes(x = reorder(region, region, function(x) -length(x)))) +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
library(ggplot2)
# use previous result
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# plot
base3=ggplot(data=plot_data) +
geom_bar(aes(x = reorder(region, region, function(x) -length(x)))) +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
library(ggplot2)
# use previous result
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# plot
base3=ggplot(data=plot_data)
base3 +  geom_bar(aes(x = reorder(region, region,
function(x) -length(x)))) +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
rm(list = ls())
###
git='https://github.com/DACSS-Fundamentals/'
org='vizandshare/raw/main/'
file='ciadata.rds'
gitLocation=paste0(git,org)
fullLocation=paste0(gitLocation,file)
cia=readRDS(url(fullLocation))
##
str(cia)
summary(cia$life_exp)
library(moments)
skewness(cia$life_exp)
# call the library
library(ggplot2) # do not expect an important message
# tell ggplot the data you will use
base=ggplot(data=cia) # I call it 'base'
# decide the plot for the variable in the data
# and see it
base + geom_boxplot(aes(x=life_exp))
base + geom_histogram(aes(x=life_exp),bins = 10)
worstCase=cia[which.min(cia$life_exp),'name']
theCaption=paste("Source:CIA\n","Worst case:",worstCase)
box=base + geom_boxplot(aes(x=life_exp))
box + labs(title='People live more than 70 years around the world',
subtitle = "147 countries, 2023",
caption = theCaption,
x= 'life expectancy')
corrtable::correlation_matrix(df = cia[,-c(1,5,6)],
use = 'lower',
replace_diagonal = T)
# install.packages("ggcorrplot")
library(ggcorrplot)
# 1. Compute the correlation matrix
corr_matrix <- cor(cia[, c('life_exp',"infant", "maternal")])
# 2. Plot
ggcorrplot(corr_matrix)
# the H
hypo=formula(life_exp ~ infant + maternal + gini)
model <- lm(hypo, data = cia)
#then
summary(model)
summary(lm(life_exp ~ maternal,data=cia))
summary(lm(life_exp ~ maternal + infant,data=cia))
summary(lm(life_exp ~ maternal + gini,data=cia))
library(sjPlot)
plot_models(model)
head(cia)
base + geom_boxplot(aes(x=life_exp,y=region))
base + geom_boxplot(aes(x=life_exp,y=reorder(region,life_exp,median)))
base +  geom_boxplot(aes(x=life_exp)) +  geom_boxplot(aes(x=infant)) +  geom_boxplot(aes(x=maternal))
cia[,c(1,2,3,4)]
head(cia[,c(1,2,3,4)])
ciaLong=tidyr::pivot_longer(data=cia[,c(1,2,3,4)],
cols=!name,
names_to = "vars",
values_to = "index")
ciaLong
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=index))
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(aes(x=vars,y=ave(index, vars, FUN = scale)))
base2 + geom_boxplot(aes(x = vars, y = index)) +
scale_y_log10()
head(cia[,c('infant','gini')])
# Find the value that marks the top 25%
infant_bad <- quantile(cia$infant, 0.75, na.rm = TRUE)
gini_bad   <- quantile(cia$gini, 0.75, na.rm = TRUE)
# Create a "High Risk" dummy variable (1 if in the worst quartile)
cia$infant_worst <- ifelse(cia$infant >= infant_bad, 1, 0)
cia$gini_worst   <- ifelse(cia$gini >= gini_bad, 1, 0)
subset(cia, infant_worst == 1 & gini_worst == 1)['region']|>table()
infant_good <- quantile(cia$infant, 0.25, na.rm = TRUE)
gini_good   <- quantile(cia$gini, 0.25, na.rm = TRUE)
cia$infant_great <- ifelse(cia$infant <= infant_good, 1, 0)
cia$gini_great   <- ifelse(cia$gini <= gini_good, 1, 0)
subset(cia, infant_great == 1 & gini_great == 1)['region']|>table()
library(ggplot2)
# use previous result
plot_data <- subset(cia, infant_great == 1 & gini_great == 1)
# plot
base3=ggplot(data=plot_data)
base3 +  geom_bar(aes(x = reorder(region, region,
function(x) -length(x)))) +
labs(title = "Regions with lowest Infant Mortality & Gini",
x = "Region",
y = "Count")
# detecting the worst case
worstCase=cia[which.min(cia$life_exp),'name']
# preparing a message
theCaption=paste("Source:CIA\n","Worst case:",worstCase)
# text for titles
theTitle='People live more than 70 years around the world'
theSubtitle="147 countries, 2023"
# time te REPLOT
box=base + geom_boxplot(aes(x=life_exp))
box + labs(title=theTitle,
subtitle = theSubtitle,
caption = theCaption,
x= 'life expectancy')
rm(list = ls())
###
git='https://github.com/DACSS-Fundamentals/'
org='vizandshare/raw/main/'
file='ciadata.rds'
gitLocation=paste0(git,org)
fullLocation=paste0(gitLocation,file)
cia=readRDS(url(fullLocation))
##
str(cia)
summary(cia$life_exp)
library(moments)
skewness(cia$life_exp)
# call the library
library(ggplot2) # do not expect an important message
# tell ggplot the data you will use
base=ggplot(data=cia) # I call it 'base'
# decide the plot for the variable in the data
# and see it
base + geom_boxplot(aes(x=life_exp))
# this is another alternative
base + geom_histogram(aes(x=life_exp),bins = 10)
# detecting the worst case
worstCase=cia[which.min(cia$life_exp),'name']
# preparing a message
theCaption=paste("Source:CIA\n","Worst case:",worstCase)
# text for titles
theTitle='People live more than 70 years around the world'
theSubtitle="147 countries, 2023"
# time te REPLOT
box=base + geom_boxplot(aes(x=life_exp))
box + labs(title=theTitle,
subtitle = theSubtitle,
caption = theCaption,
x= 'life expectancy')
head(cia)
base+geom_boxplot(aes(x=infant,y=`infant`)) +
geom_boxplot(aes(x=maternal,y=`maternal`)) labs(y='')
base+geom_boxplot(aes(x=infant,y=`infant`)) +
geom_boxplot(aes(x=maternal,y=`maternal`)) + labs(y='')
base+geom_boxplot(aes(x=as.ordered(infant),y=infant)) +
geom_boxplot(aes(x=as.ordered(maternal),y=maternal)) + labs(y='')
base+geom_boxplot(aes(x=as.ordered(infant),y=infant)) +
geom_boxplot(aes(x=as.ordered(maternal),y=`maternal`)) + labs(y='')
base+geom_boxplot(aes(x=as.ordered(infant),y=`infant`)) +
geom_boxplot(aes(x=as.ordered(maternal),y=`maternal`)) + labs(y='')
base+geom_boxplot(aes(x=infant,y=infant)) +
geom_boxplot(aes(x=maternal,y=maternal)) + labs(y='')
base +  geom_boxplot(aes(x=life_exp)) +  geom_boxplot(aes(x=infant)) +  geom_boxplot(aes(x=maternal))
base+geom_boxplot(aes(x=infant,y=infant)) +
geom_boxplot(aes(x=maternal,y=maternal)) + labs(y='')
cia[,c(1,2,3,4)]
ciaLong=tidyr::pivot_longer(data=cia[,c(1,2,3,4)],
cols=!name,
names_to = "vars",
values_to = "index")
ciaLong
ciaLong=tidyr::pivot_longer(data=cia[,c(1,2,3,4,5)],
cols=!name,
names_to = "vars",
values_to = "index")
ciaLong
ciaLong=tidyr::pivot_longer(data=cia[,c(1,2,3,4)],
cols=!name,
names_to = "vars",
values_to = "index")
ciaLong
# then
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=index))
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(y=index) +
facet_wrap(~ vars, scales = "free")
# then
base = ggplot(data=ciaLong)
base + geom_boxplot(aes(x=vars,y=index))
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(aes(y=index)) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(aes(y=index)) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(y=index)) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(y=index),bins=10) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~., scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(y=index),bins=10) +
facet_wrap(vars~., scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~., scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(~vars, scales = "free", ncol = 1)
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(aes(x=index)) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_boxplot(aes(y=index)) +
facet_wrap(~ vars, scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(y=index),bins=10) +
facet_wrap(~vars, scales = "free", ncol = 1)
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(~vars, scales = "free", ncol = 1)
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars, scales = "free", ncol = 1)
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~., scales = "free", ncol = 1)
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~., scales = "free")
base2 = ggplot(data=ciaLong)
base2 + geom_histogram(aes(x=index),bins=10) +
facet_wrap(vars~., scales = "free", ncol = 1)
head(cia[,c('infant','maternal')])
# Find the value that marks the top 25% (worst)
inf_bad <- quantile(cia$infant, 0.75, na.rm = TRUE)
mat_bad   <- quantile(cia$maternal, 0.75, na.rm = TRUE)
# 1 if in the worst quartile:
cia$inf_worst <- ifelse(cia$infant >= inf_bad, 1, 0)
cia$mat_worst   <- ifelse(cia$maternal >= mat_bad, 1, 0)
aggregate(data=cia,inf_worst~mat_worst)
aggregate(data=cia,inf_worst~mat_worst,sum)
aggregate(cbind(count = inf_worst == mat_worst) ~ mat_worst,
data  = cia,
FUN   = sum,
na.rm = TRUE)
aggregate(cbind(count = inf_worst == mat_worst) ~ mat_worst + region,
data  = cia,
FUN   = sum,
na.rm = TRUE)
cia$worst_infmat=cia$inf_worst + cia$mat_worst
aggregate(worst_infmat ~ region, data = cia, FUN = sum)
cia$worst_infmat=ifelse(cia$worst_infmat==2,T,F)
aggregate(worst_infmat ~ region, data = cia, FUN = sum)
aggregate(worst_infmat ~ region, data = cia, FUN = sum, na.rm = TRUE)
inf_good <- quantile(cia$infant, 0.25, na.rm = TRUE)
mat_good   <- quantile(cia$maternal, 0.25, na.rm = TRUE)
# NOW 'less than'
cia$inf_best <- ifelse(cia$infant <= inf_good, 1, 0)
cia$mat_best   <- ifelse(cia$maternal <= mat_good, 1, 0)
# flag worst of worst
cia$best_infmat=cia$inf_best + cia$mat_best
cia$best_infmat=ifelse(cia$best_infmat==2,T,F)
aggregate(best_infmat ~ region, data = cia, FUN = sum, na.rm = TRUE)
names(cia)
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
ggplot(counts, aes(x = reorder(region, -worst_infmat),  # order bars
y = worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region",
y = "Countries with both worst infant & maternal mortality",
title = "Count of countries flagged 'worst' on both indicators") +
theme_minimal(base_size = 12)
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
counts |> filter(worst_infmat > 0) %>%
ggplot(aes(reorder(region, -worst_infmat), worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region", y = "Count") +
theme_minimal()
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
counts %>% filter(worst_infmat > 0) %>%
ggplot(aes(reorder(region, -worst_infmat), worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region", y = "Count") +
theme_minimal()
counts
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
counts %>% filter(worst_infmat > 0) %>%
ggplot(aes(reorder(region, -worst_infmat), worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region", y = "Count") +
theme_minimal()
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
counts=counts[counts$worst_infmat>0,]
ggplot(counts, aes(x = reorder(region, -worst_infmat),  # order bars
y = worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region",
y = "Countries with both worst infant & maternal mortality",
title = "Count of countries flagged 'worst' on both indicators") +
theme_minimal(base_size = 12)
library(ggplot2)
# count TRUEs per region
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
counts=counts[counts$worst_infmat>0,]
ggplot(counts, aes(x = reorder(region, -worst_infmat),  # order bars
y = worst_infmat)) +
geom_col(fill = "firebrick") +
labs(x = "Region",
y = "Count",
title = "Count of countries flagged 'worst' on both indicators") +
theme_minimal(base_size = 12)
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
# filter
counts=counts[counts$worst_infmat>0,]
newbase=ggplot(counts)
newbase + geom_bar(aes(x = reorder(region, -worst_infmat),
y = worst_infmat))
counts <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
# filter
counts=counts[counts$worst_infmat>0,]
newbase=ggplot(counts)
newbase + geom_col(aes(x = reorder(region, -worst_infmat),
y = worst_infmat))
# saving as object
counts_worst <- aggregate(worst_infmat ~ region, data = cia, FUN = sum)
# filtering
counts_worst=counts_worst[counts_worst$worst_infmat>0,]
# plotting
base_worst=ggplot(counts_worst)
base_worst + geom_col(aes(x = reorder(region, -worst_infmat),
y = worst_infmat))
# saving as object
counts_best <- aggregate(best_infmat ~ region, data = cia, FUN = sum)
# filtering
counts_best=counts_best[counts_best$worst_infmat>0,]
# plotting
base_best=ggplot(data=counts_best)
base_best + geom_col(aes(x = reorder(region, -best_infmat),
y = best_infmat))
counts_best
aggregate(best_infmat ~ region, data = cia, FUN = sum)
counts_best <- aggregate(best_infmat ~ region, data = cia, FUN = sum)
counts_best
counts_best=counts_best[counts_best$best_infmat>0,]
counts_best
# saving as object
counts_best <- aggregate(best_infmat ~ region, data = cia, FUN = sum)
# filtering
counts_best=counts_best[counts_best$best_infmat>0,]
# plotting
base_best=ggplot(data=counts_best)
base_best + geom_col(aes(x = reorder(region, -best_infmat),
y = best_infmat))
?mean
